import { Link } from "react-router-dom";
import styles from "./Exercise.module.css";
import DeleteButton from "./DeleteButton";
import { format, isSameDay } from "date-fns";

const formatToThreeDigits = (num) => String(num).padStart(3, "0");

function Exercise({ exercise, onDelete, selectedDate, from }) {
  const restTime = formatToThreeDigits(exercise.restTime);
  const today = new Date();
  const dateStr = format(selectedDate, "yyyy-MM-dd");

  return (
    <Link
      to={`/exercise/${dateStr}/${exercise.id}`}
      className={styles.exerciseLink}
      state={{ from, selectedDate }}
    >
      <div className={styles.exerciseContainer}>
        {isSameDay(today, selectedDate) && <DeleteButton onDelete={onDelete} />}

        <p className={styles.exerciseName}>{exercise.name}</p>
        <div className={styles.ExerciseParametersContainer}>
          <div className={styles.parameterDiv}>
            <div className={styles.svgContainer1}>
              <svg
                width="16"
                height="13"
                viewBox="0 0 16 13"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <g clipPath="url(#clip0_36_438)">
                  <path
                    d="M2.4 1.625C2.4 1.17559 2.7575 0.8125 3.2 0.8125H4C4.4425 0.8125 4.8 1.17559 4.8 1.625V5.6875V7.3125V11.375C4.8 11.8244 4.4425 12.1875 4 12.1875H3.2C2.7575 12.1875 2.4 11.8244 2.4 11.375V9.75H1.6C1.1575 9.75 0.8 9.38691 0.8 8.9375V7.3125C0.3575 7.3125 0 6.94941 0 6.5C0 6.05059 0.3575 5.6875 0.8 5.6875V4.0625C0.8 3.61309 1.1575 3.25 1.6 3.25H2.4V1.625ZM13.6 1.625V3.25H14.4C14.8425 3.25 15.2 3.61309 15.2 4.0625V5.6875C15.6425 5.6875 16 6.05059 16 6.5C16 6.94941 15.6425 7.3125 15.2 7.3125V8.9375C15.2 9.38691 14.8425 9.75 14.4 9.75H13.6V11.375C13.6 11.8244 13.2425 12.1875 12.8 12.1875H12C11.5575 12.1875 11.2 11.8244 11.2 11.375V7.3125V5.6875V1.625C11.2 1.17559 11.5575 0.8125 12 0.8125H12.8C13.2425 0.8125 13.6 1.17559 13.6 1.625ZM10.4 5.6875V7.3125H5.6V5.6875H10.4Z"
                    fill="#FDFBF9"
                    fillOpacity="0.87"
                  />
                </g>
                <defs>
                  <clipPath id="clip0_36_438">
                    <rect width="16" height="13" fill="white" />
                  </clipPath>
                </defs>
              </svg>
            </div>
            &nbsp;&nbsp;
            <span>{exercise.set}</span> &nbsp;sets
          </div>
          <div className={styles.parameterDiv}>
            <div className={styles.svgContainer2}>
              <svg
                width="15"
                height="15"
                viewBox="0 0 15 15"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M9.64931 6.96996L10.8961 5.80087C11.6355 5.10768 12.0549 4.13971 12.0549 3.1263V1.44012C12.0551 1.0442 11.8929 0.680801 11.6329 0.421934C11.374 0.161983 11.0107 -0.000263351 10.6148 3.2089e-07H4.38516C3.98924 -0.000263351 3.62561 0.161983 3.36671 0.421905C3.10682 0.680801 2.94454 1.04417 2.94507 1.44009V3.12624C2.94507 4.13965 3.36445 5.10765 4.10382 5.80081L5.3504 6.9694C5.41901 7.034 5.45816 7.12383 5.45816 7.21819V7.78169C5.45816 7.87605 5.41901 7.96564 5.35067 8.03001L4.10385 9.1991C3.36448 9.89203 2.9451 10.8603 2.9451 11.8737V13.5598C2.94457 13.9558 3.10688 14.3191 3.36674 14.578C3.62567 14.8379 3.98927 15.0002 4.38519 14.9999H10.6148C11.0107 15.0002 11.3741 14.8379 11.633 14.578C11.8929 14.3191 12.0551 13.9558 12.0549 13.5598V11.8737C12.0549 10.8603 11.6355 9.89209 10.8962 9.19916L9.64957 8.0303C9.58066 7.9657 9.54182 7.87611 9.54182 7.78175V7.21825C9.54179 7.12389 9.58067 7.03406 9.64931 6.96996ZM10.9554 13.5599C10.9552 13.6558 10.9181 13.7373 10.8555 13.8006C10.7921 13.8632 10.7106 13.9003 10.6147 13.9005H4.38516C4.28927 13.9003 4.2075 13.8632 4.14416 13.8006C4.08158 13.7373 4.04476 13.6558 4.04449 13.5599V11.8737C4.04449 11.1644 4.33822 10.4863 4.85575 10.0014L6.10234 8.83225C6.39278 8.56022 6.55758 8.17972 6.55758 7.78175V7.21825C6.55758 6.82005 6.39278 6.43954 6.1021 6.16749L4.85575 4.99866C4.33819 4.51368 4.04449 3.83587 4.04449 3.1263V1.44012C4.04476 1.34423 4.08158 1.26272 4.14416 1.19912C4.2075 1.13681 4.28927 1.09969 4.38516 1.09945H10.6147C10.7106 1.09969 10.7921 1.13678 10.8555 1.19912C10.9181 1.26272 10.9552 1.3442 10.9554 1.44012V3.12627C10.9554 3.83584 10.6617 4.51365 10.1441 4.99863L8.89755 6.16746C8.6071 6.43951 8.44233 6.82002 8.44233 7.21822V7.78172C8.44233 8.17969 8.60713 8.56019 8.89781 8.83271L10.1441 10.0011C10.6617 10.4863 10.9554 11.1644 10.9554 11.8737V13.5599Z"
                  fill="#FDFBF9"
                  fillOpacity="0.87"
                />
                <path
                  d="M6.95095 11.1021L4.68542 13.3676H10.3142L8.04865 11.1021C7.7456 10.7993 7.25429 10.7993 6.95095 11.1021Z"
                  fill="#FDFBF9"
                  fillOpacity="0.87"
                />
              </svg>
            </div>
            &nbsp;
            <span>{restTime}</span>s
          </div>
        </div>
      </div>
    </Link>
  );
}

export default Exercise;
